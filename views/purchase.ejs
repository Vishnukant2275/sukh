<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Purchase <%= product.name %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <div class="row g-4">
        <!-- Left: Product details -->
        <div class="col-md-6">
          <div class="card shadow-lg border-0 h-100">
            <img
              src="data:<%= product.image.contentType %>;base64,<%= product.image.data.toString('base64') %>"
              class="card-img-top rounded-top"
              alt="<%= product.name %>"
            />

            <div class="card-body">
              <h3 class="card-title mb-3"><%= product.name %></h3>
              <h4 class="text-success mb-3">â‚¹ <%= product.price %></h4>
              <p class="text-muted"><%= product.description %></p>
              <ul class="list-group list-group-flush mt-3">
                <li class="list-group-item">
                  <strong>Category:</strong> <%= product.category || "N/A" %>
                </li>
                <li class="list-group-item">
                  <strong>Stock:</strong> <%= product.stock || "Available" %>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Right: Purchase form -->
        <div class="col-md-6">
          <div class="card shadow-lg border-0 p-4 h-100">
            <h4 class="mb-4 text-center text-primary">
              Complete Your Purchase
            </h4>
            <form action="/purchase/<%= product._id %>" method="POST">
  <!-- Quantity -->
  <div class="mb-3">
    <label for="quantity" class="form-label">Quantity</label>
    <input
      type="number"
      name="quantity"
      id="quantity"
      class="form-control"
      min="1"
      value="1"
      required
    />
  </div>

  <!-- Name & Mobile -->
  <div class="row mb-3">
    <div class="col">
      <input
        type="text"
        name="name"
        class="form-control"
        placeholder="Name"
        required
      />
    </div>
    <div class="col">
      <input
        type="tel"
        name="mobile"
        class="form-control"
        placeholder="10-digit mobile number"
        pattern="[0-9]{10}"
        required
      />
    </div>
  </div>

  <!-- Pincode & Locality -->
  <div class="row mb-3">
    <div class="col">
      <input
        type="text"
        name="pincode"
        class="form-control"
        placeholder="Pincode"
        required
      />
    </div>
    <div class="col">
      <input
        type="text"
        name="locality"
        class="form-control"
        placeholder="Locality"
        required
      />
    </div>
  </div>

  <!-- Address -->
  <div class="mb-3">
    <textarea
      name="address"
      id="address"
      class="form-control"
      rows="2"
      placeholder="Address (Area and Street)"
      required
    ></textarea>
  </div>

  <!-- City & State -->
  <div class="row mb-3">
    <div class="col">
      <input
        type="text"
        name="city"
        class="form-control"
        placeholder="City/District/Town"
        required
      />
    </div>
     <div class="col mb-3">
    <div class="col">
      <input
        type="text"
        name="State"
        class="form-control"
        placeholder="State eg. Madhya Pradesh"
        required
      />
    </div>
  </div>

  <!-- Landmark & Alternate Phone -->
  <div class="row mb-3">
    <div class="col">
      <input
        type="text"
        name="landmark"
        class="form-control"
        placeholder="Landmark (Optional)"
      />
    </div>
    <div class="col">
      <input
        type="tel"
        name="altPhone"
        class="form-control"
        placeholder="Alternate Phone (Optional)"
        pattern="[0-9]{10}"
      />
    </div>
  </div>

 

  <!-- Payment Method -->
  <div class="mb-3">
    <label for="paymentMethod" class="form-label">Payment Method</label>
    <select
      name="paymentMethod"
      id="paymentMethod"
      class="form-select"
      required
    >
      <option
        value="UPI"
        style="background-color: #cce5ff; font-weight: bold; color: #004085;"
      >
        UPI Only
      </option>
    </select>
  </div>

  <button
    type="submit"
    class="btn btn-success w-100 py-2"
    >
    Confirm & Pay
  </button>
</form>

          </div>
        </div>
      </div>
    </div>
    <script>
      async function purchase(productId, quantity) {
        try {
         await fetch(`/purchase/${productId}`, {
        
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({ quantity: quantity })
});

        } catch (err) {
          console.log(err);
        }
      }
    </script>
  </body>
</html>
